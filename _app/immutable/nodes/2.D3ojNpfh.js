import"../chunks/DsnmJJEf.js";import{i as De}from"../chunks/u7fxxcxQ.js";import{am as ie,B as Me,v as Be,i as Re,an as Ve,ao as Ce,ap as Ee,e as pe,C as be,o as ge,aq as D,ar as $e,Z as je,X as Fe,V as He,Y as ee,$ as x,a1 as o,O as a,W as Le,_ as Te,as as y,at as he,a0 as k,au as q,av as V}from"../chunks/CHSjGI8C.js";import{e as ae,s as te}from"../chunks/Dad-zfWe.js";import{r as C}from"../chunks/EUNXujx8.js";import{b as Ae}from"../chunks/CL6TKqGZ.js";function xe(e,i,p=!1){if(e.multiple){if(i==null)return;if(!Re(i))return Ve();for(var n of e.options)n.selected=i.includes(M(n));return}for(n of e.options){var s=M(n);if(Ce(s,i)){n.selected=!0;return}}(!p||i!==void 0)&&(e.selectedIndex=-1)}function Oe(e){var i=new MutationObserver(()=>{xe(e,e.__value)});i.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Be(()=>{i.disconnect()})}function me(e,i,p=i){var n=!0;ie(e,"change",s=>{var u=s?"[selected]":":checked",h;if(e.multiple)h=[].map.call(e.querySelectorAll(u),M);else{var g=e.querySelector(u)??e.querySelector("option:not([disabled])");h=g&&M(g)}p(h)}),Me(()=>{var s=i();if(xe(e,s,n),n&&s===void 0){var u=e.querySelector(":checked");u!==null&&(s=M(u),p(s))}e.__value=s,n=!1}),Oe(e)}function M(e){return"__value"in e?e.__value:e.value}function re(e,i,p=i){var n=Ee(),s=new WeakSet;ie(e,"input",u=>{var h=u?e.defaultValue:e.value;if(h=le(e)?ne(h):h,p(h),D!==null&&s.add(D),n&&h!==(h=i())){var g=e.selectionStart,w=e.selectionEnd;e.value=h??"",w!==null&&(e.selectionStart=g,e.selectionEnd=Math.min(w,e.value.length))}}),(ge&&e.defaultValue!==e.value||pe(i)==null&&e.value)&&(p(le(e)?ne(e.value):e.value),D!==null&&s.add(D)),be(()=>{var u=i();if(e===document.activeElement){var h=$e??D;if(s.has(h))return}le(e)&&u===ne(e.value)||e.type==="date"&&!u&&!e.value||u!==e.value&&(e.value=u??"")})}function Ue(e,i,p=i){ie(e,"change",n=>{var s=n?e.defaultChecked:e.checked;p(s)}),(ge&&e.defaultChecked!==e.checked||pe(i)==null)&&p(e.checked),be(()=>{var n=i();e.checked=!!n})}function le(e){var i=e.type;return i==="number"||i==="range"}function ne(e){return e===""?null:+e}var We=Fe('<div class="controls svelte-2dzqdd"><input type="file" accept="image/*"/> <label for="direction" class="svelte-2dzqdd">Direction: <select id="direction"><option>Horizontal</option><option>Vertical</option></select></label> <label for="sort" class="svelte-2dzqdd">Sort by: <select id="sort"><option>Brightness</option><option>Red</option><option>Green</option><option>Blue</option><option>Hue</option><option>Saturation</option><option>Lightness</option></select></label> <label for="threshold" class="svelte-2dzqdd">Threshold: <input type="range" min="0" max="255" id="threshold"/> </label> <label for="jitter" class="svelte-2dzqdd">Jitter: <input type="range" min="0" max="1" step="0.01" id="jitter"/> </label> <label for="reverse" class="svelte-2dzqdd">Reverse: <input type="checkbox" id="reverse"/></label> <label for="blend" class="svelte-2dzqdd">Blend: <input type="range" min="0" max="100" id="blend"/> </label> <button>Sort</button> <button>Reset</button></div> <canvas class="border mt-2 svelte-2dzqdd"></canvas>',1);function Ne(e,i){je(i,!1);let p=null,n=y(),s,u=y(null),h=null,g=y("horizontal"),w=y("brightness"),I=y(0),z=y(0),B=y(!1),S=y(100);function ke(t){const c=t.target.files?.[0];if(!c)return;const v=new FileReader;v.onload=l=>{p=l.target?.result,q(u,new Image),V(u,a(u).src=p),V(u,a(u).onload=()=>{V(n,a(n).width=a(u).width),V(n,a(n).height=a(u).height),s=a(n).getContext("2d"),s.drawImage(a(u),0,0),h=s.getImageData(0,0,a(n).width,a(n).height)})},v.readAsDataURL(c)}function ye(){if(!s)return;const{width:t,height:c}=a(n),v=s.getImageData(0,0,t,c),l=v.data;if(a(g)==="horizontal")for(let m=0;m<c;m++){const f=[],b=[];for(let d=0;d<t;d++){const r=(m*t+d)*4,_=[l[r],l[r+1],l[r+2],l[r+3]];oe(_)&&(f.push(_),b.push(r))}f.sort((d,r)=>{let _=R(d)-R(r);return a(z)>0&&(_+=(Math.random()-.5)*a(z)*50),_}),a(B)&&f.reverse();for(let d=0;d<b.length;d++){const r=b[d],_=f[d];l[r]=_[0],l[r+1]=_[1],l[r+2]=_[2],l[r+3]=_[3]}}else for(let m=0;m<t;m++){const f=[],b=[];for(let d=0;d<c;d++){const r=(d*t+m)*4,_=[l[r],l[r+1],l[r+2],l[r+3]];oe(_)&&(f.push(_),b.push(r))}f.sort((d,r)=>{let _=R(d)-R(r);return a(z)>0&&(_+=(Math.random()-.5)*a(z)*50),_}),a(B)&&f.reverse();for(let d=0;d<b.length;d++){const r=b[d],_=f[d];l[r]=_[0],l[r+1]=_[1],l[r+2]=_[2],l[r+3]=_[3]}}if(a(S)<100&&h){const m=h.data;for(let f=0;f<l.length;f++)l[f]=Math.round(a(S)/100*l[f]+(1-a(S)/100)*m[f])}s.putImageData(v,0,0)}function qe(){a(u)&&s&&s.drawImage(a(u),0,0)}function R([t,c,v,l]){switch(a(w)){case"red":return t;case"green":return c;case"blue":return v;case"brightness":return(t+c+v)/3;case"hue":return E(t,c,v)[0]*360;case"saturation":return E(t,c,v)[1]*100;case"lightness":return E(t,c,v)[2]*100}}function oe([t,c,v,l]){return a(I)<=0?!0:(t+c+v)/3>=a(I)}function E(t,c,v){t/=255,c/=255,v/=255;const l=Math.max(t,c,v),m=Math.min(t,c,v);let f=0,b=0,d=(l+m)/2;if(l!==m){const r=l-m;switch(b=d>.5?r/(2-l-m):r/(l+m),l){case t:f=(c-v)/r+(c<v?6:0);break;case c:f=(v-t)/r+2;break;case v:f=(t-c)/r+4;break}f/=6}return[f,b,d]}De();var se=We(),$=He(se),ue=x($),j=o(ue,2),F=o(x(j));ee(()=>{a(g),he(()=>{})});var H=x(F);H.value=H.__value="horizontal";var de=o(H);de.value=de.__value="vertical",k(F),k(j);var L=o(j,2),T=o(x(L));ee(()=>{a(w),he(()=>{})});var A=x(T);A.value=A.__value="brightness";var O=o(A);O.value=O.__value="red";var U=o(O);U.value=U.__value="green";var W=o(U);W.value=W.__value="blue";var G=o(W);G.value=G.__value="hue";var J=o(G);J.value=J.__value="saturation";var ce=o(J);ce.value=ce.__value="lightness",k(T),k(L);var X=o(L,2),Y=o(x(X));C(Y);var we=o(Y);k(X);var Z=o(X,2),K=o(x(Z));C(K);var ze=o(K);k(Z);var N=o(Z,2),ve=o(x(N));C(ve),k(N);var P=o(N,2),Q=o(x(P));C(Q);var Se=o(Q);k(P);var fe=o(P,2),_e=o(fe,2);k($);var Ie=o($,2);Ae(Ie,t=>q(n,t),()=>a(n)),ee(t=>{te(we,` ${a(I)??""}`),te(ze,` ${t??""}%`),te(Se,` ${a(S)??""}%`),_e.disabled=!a(u)},[()=>Math.round(a(z)*100)]),ae("change",ue,ke),me(F,()=>a(g),t=>q(g,t)),me(T,()=>a(w),t=>q(w,t)),re(Y,()=>a(I),t=>q(I,t)),re(K,()=>a(z),t=>q(z,t)),Ue(ve,()=>a(B),t=>q(B,t)),re(Q,()=>a(S),t=>q(S,t)),ae("click",fe,ye),ae("click",_e,qe),Le(e,se),Te()}export{Ne as component};
