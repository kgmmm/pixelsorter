import"../chunks/DsnmJJEf.js";import{i as Be}from"../chunks/m9mP23i-.js";import{o as $,an as oe,B as je,v as Re,i as Ve,ao as $e,ap as ze,aq as Ce,e as ge,C as we,ar as q,as as Ee,_ as Fe,X as He,V as Le,Z as te,a0 as w,a2 as c,O as t,W as Ne,$ as Te,a1 as y,at as x,au as pe,av as k,aw as R}from"../chunks/DYG4gB_x.js";import{e as re,s as le}from"../chunks/DwI75ph0.js";import{r as V}from"../chunks/DqClaG5s.js";import{b as Ue}from"../chunks/BY1UPKbF.js";function ye(e){var r,o,a="";if(typeof e=="string"||typeof e=="number")a+=e;else if(typeof e=="object")if(Array.isArray(e)){var s=e.length;for(r=0;r<s;r++)e[r]&&(o=ye(e[r]))&&(a&&(a+=" "),a+=o)}else for(o in e)e[o]&&(a&&(a+=" "),a+=o);return a}function Oe(){for(var e,r,o=0,a="",s=arguments.length;o<s;o++)(e=arguments[o])&&(r=ye(e))&&(a&&(a+=" "),a+=r);return a}function We(e){return typeof e=="object"?Oe(e):e??""}function Ge(e,r,o){var a=e==null?"":""+e;return a=a?a+" "+r:r,a===""?null:a}function Je(e,r,o,a,s,u){var m=e.__className;if($||m!==o||m===void 0){var b=Ge(o,a);(!$||b!==e.getAttribute("class"))&&(b==null?e.removeAttribute("class"):e.className=b),e.__className=o}return u}function xe(e,r,o=!1){if(e.multiple){if(r==null)return;if(!Ve(r))return $e();for(var a of e.options)a.selected=r.includes(A(a));return}for(a of e.options){var s=A(a);if(ze(s,r)){a.selected=!0;return}}(!o||r!==void 0)&&(e.selectedIndex=-1)}function Xe(e){var r=new MutationObserver(()=>{xe(e,e.__value)});r.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Re(()=>{r.disconnect()})}function be(e,r,o=r){var a=!0;oe(e,"change",s=>{var u=s?"[selected]":":checked",m;if(e.multiple)m=[].map.call(e.querySelectorAll(u),A);else{var b=e.querySelector(u)??e.querySelector("option:not([disabled])");m=b&&A(b)}o(m)}),je(()=>{var s=r();if(xe(e,s,a),a&&s===void 0){var u=e.querySelector(":checked");u!==null&&(s=A(u),o(s))}e.__value=s,a=!1}),Xe(e)}function A(e){return"__value"in e?e.__value:e.value}function ne(e,r,o=r){var a=Ce(),s=new WeakSet;oe(e,"input",u=>{var m=u?e.defaultValue:e.value;if(m=ie(e)?se(m):m,o(m),q!==null&&s.add(q),a&&m!==(m=r())){var b=e.selectionStart,S=e.selectionEnd;e.value=m??"",S!==null&&(e.selectionStart=b,e.selectionEnd=Math.min(S,e.value.length))}}),($&&e.defaultValue!==e.value||ge(r)==null&&e.value)&&(o(ie(e)?se(e.value):e.value),q!==null&&s.add(q)),we(()=>{var u=r();if(e===document.activeElement){var m=Ee??q;if(s.has(m))return}ie(e)&&u===se(e.value)||e.type==="date"&&!u&&!e.value||u!==e.value&&(e.value=u??"")})}function Ze(e,r,o=r){oe(e,"change",a=>{var s=a?e.defaultChecked:e.checked;o(s)}),($&&e.defaultChecked!==e.checked||ge(r)==null)&&o(e.checked),we(()=>{var a=r();e.checked=!!a})}function ie(e){var r=e.type;return r==="number"||r==="range"}function se(e){return e===""?null:+e}var Ke=He('<div class="controls svelte-1ghmaiw"><label for="file" class="svelte-1ghmaiw">Upload <input type="file" accept="image/*" id="file" class="svelte-1ghmaiw"/></label> <label for="direction" class="svelte-1ghmaiw">Direction: <select id="direction"><option>Horizontal</option><option>Vertical</option></select></label> <label for="sort" class="svelte-1ghmaiw">Sort by: <select id="sort"><option>Brightness</option><option>Red</option><option>Green</option><option>Blue</option><option>Hue</option><option>Saturation</option><option>Lightness</option></select></label> <label for="threshold" class="svelte-1ghmaiw">Threshold: <input type="range" min="0" max="255" id="threshold"/> </label> <label for="jitter" class="svelte-1ghmaiw">Jitter: <input type="range" min="0" max="1" step="0.01" id="jitter"/> </label> <label for="reverse" class="svelte-1ghmaiw">Reverse: <input type="checkbox" id="reverse"/></label> <label for="blend" class="svelte-1ghmaiw">Blend: <input type="range" min="0" max="100" id="blend"/> </label> <button class="svelte-1ghmaiw">Sort</button> <button class="svelte-1ghmaiw">Reset</button></div> <canvas></canvas>',1);function ra(e,r){Fe(r,!1);let o=null,a=x(),s,u=x(null),m=null,b=x("horizontal"),S=x("brightness"),M=x(0),I=x(0),B=x(!1),D=x(100);function ke(l){const f=l.target.files?.[0];if(!f)return;const d=new FileReader;d.onload=i=>{o=i.target?.result,k(u,new Image),R(u,t(u).src=o),R(u,t(u).onload=()=>{R(a,t(a).width=t(u).width),R(a,t(a).height=t(u).height),s=t(a).getContext("2d"),s.drawImage(t(u),0,0),m=s.getImageData(0,0,t(a).width,t(a).height)})},d.readAsDataURL(f)}function Se(){if(!s)return;const{width:l,height:f}=t(a),d=s.getImageData(0,0,l,f),i=d.data;if(t(b)==="horizontal")for(let p=0;p<f;p++){const h=[],g=[];for(let v=0;v<l;v++){const n=(p*l+v)*4,_=[i[n],i[n+1],i[n+2],i[n+3]];ue(_)&&(h.push(_),g.push(n))}h.sort((v,n)=>{let _=j(v)-j(n);return t(I)>0&&(_+=(Math.random()-.5)*t(I)*50),_}),t(B)&&h.reverse();for(let v=0;v<g.length;v++){const n=g[v],_=h[v];i[n]=_[0],i[n+1]=_[1],i[n+2]=_[2],i[n+3]=_[3]}}else for(let p=0;p<l;p++){const h=[],g=[];for(let v=0;v<f;v++){const n=(v*l+p)*4,_=[i[n],i[n+1],i[n+2],i[n+3]];ue(_)&&(h.push(_),g.push(n))}h.sort((v,n)=>{let _=j(v)-j(n);return t(I)>0&&(_+=(Math.random()-.5)*t(I)*50),_}),t(B)&&h.reverse();for(let v=0;v<g.length;v++){const n=g[v],_=h[v];i[n]=_[0],i[n+1]=_[1],i[n+2]=_[2],i[n+3]=_[3]}}if(t(D)<100&&m){const p=m.data;for(let h=0;h<i.length;h++)i[h]=Math.round(t(D)/100*i[h]+(1-t(D)/100)*p[h])}s.putImageData(d,0,0)}function Ie(){t(u)&&s&&s.drawImage(t(u),0,0)}function j([l,f,d,i]){switch(t(S)){case"red":return l;case"green":return f;case"blue":return d;case"brightness":return(l+f+d)/3;case"hue":return z(l,f,d)[0]*360;case"saturation":return z(l,f,d)[1]*100;case"lightness":return z(l,f,d)[2]*100}}function ue([l,f,d,i]){return t(M)<=0?!0:(l+f+d)/3>=t(M)}function z(l,f,d){l/=255,f/=255,d/=255;const i=Math.max(l,f,d),p=Math.min(l,f,d);let h=0,g=0,v=(i+p)/2;if(i!==p){const n=i-p;switch(g=v>.5?n/(2-i-p):n/(i+p),i){case l:h=(f-d)/n+(f<d?6:0);break;case f:h=(d-l)/n+2;break;case d:h=(l-f)/n+4;break}h/=6}return[h,g,v]}Be();var ce=Ke(),C=Le(ce),E=w(C),De=c(w(E));y(E);var F=c(E,2),H=c(w(F));te(()=>{t(b),pe(()=>{})});var L=w(H);L.value=L.__value="horizontal";var ve=c(L);ve.value=ve.__value="vertical",y(H),y(F);var N=c(F,2),T=c(w(N));te(()=>{t(S),pe(()=>{})});var U=w(T);U.value=U.__value="brightness";var O=c(U);O.value=O.__value="red";var W=c(O);W.value=W.__value="green";var G=c(W);G.value=G.__value="blue";var J=c(G);J.value=J.__value="hue";var X=c(J);X.value=X.__value="saturation";var fe=c(X);fe.value=fe.__value="lightness",y(T),y(N);var Z=c(N,2),K=c(w(Z));V(K);var Me=c(K);y(Z);var P=c(Z,2),Q=c(w(P));V(Q);var qe=c(Q);y(P);var Y=c(P,2),de=c(w(Y));V(de),y(Y);var ee=c(Y,2),ae=c(w(ee));V(ae);var Ae=c(ae);y(ee);var he=c(ee,2),_e=c(he,2);y(C);var me=c(C,2);Ue(me,l=>k(a,l),()=>t(a)),te(l=>{le(Me,` ${t(M)??""}`),le(qe,` ${l??""}%`),le(Ae,` ${t(D)??""}%`),_e.disabled=!t(u),Je(me,1,We(t(u)?"":"hide"),"svelte-1ghmaiw")},[()=>Math.round(t(I)*100)]),re("change",De,ke),be(H,()=>t(b),l=>k(b,l)),be(T,()=>t(S),l=>k(S,l)),ne(K,()=>t(M),l=>k(M,l)),ne(Q,()=>t(I),l=>k(I,l)),Ze(de,()=>t(B),l=>k(B,l)),ne(ae,()=>t(D),l=>k(D,l)),re("click",he,Se),re("click",_e,Ie),Ne(e,ce),Te()}export{ra as component};
